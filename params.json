{"name":"Niuben.GitHub.io","tagline":"博客","body":"Webpack CommonChunkPlugin详解# \r\n\r\nwebpack介绍## \r\n### Webpack最近比较流行前端构建工具.它通过分析代码中require调用方式，将代码进行模块化打包，相关多个JS文件会打包成一个文件。同时Webpack还具有MD5版本、内置开发调试服务器等功能；相比Grunt和Gulp等任务流构建工具，Webpack具有模块化打包能力。\r\n### CommonChunkPlugin插件是Webpack官方插件，用于公共文件提取打包；将多个模块都调用到文件，打包到一个公共Chunk中；避免多个模块重复打包相同文件，大大降低整体文件大小；\r\n\r\n##CommonChunkPlugin参数列表\r\n\r\n* name: 公共包名称叫什么。如果存在包名和name相同的话，这个包会变成公共包；如果name是数组会调用数组中每个名字；每个名字都可能是公共文件；如果这个参数没有赋值，所有包都会被选中；\r\n* filename: 公共包文件格式；\r\n* minChunks: 一个包放入公共包需要的最小次数；\r\n* chunks: 那些包会被选中，如果这个值忽略，所有entry包都会被选中；\r\n* children: 如果为true，公共包子元素都会被选中；\r\n* async: 如果为true，会创建一个async公共包，会和其他包共同加载；\r\n* minsize: 可以打包的最小质量；比如100KB；\r\n\r\n\r\n## CommonChunkPlugin实现原理\r\n### 调试Webpack\r\n前端需要使用工具来调试，方便知道程序中变量的值和逻辑运行情况；node-inspector是专门调试node程序；使用之前需要将node版本升级，如果版本过低，有些功能无法使用；按照使用如下：\r\n1. npm install node-inspector -g  \r\n2. npm-inspector\r\n3. 进入项目文件夹，找到webpack.config.js文件；\r\n4. node --debug-brk node_modules/webpack/bin/webpack.js(webpack所在文件夹）\r\n5. 打开chrome浏览器，输入http://127.0.0.1:8080/?ws=127.0.0.1:8080&port=5858；\r\n\r\n### 公共文件数据结构\r\n有三个数据类型需要理解：block、module、chunk；\r\n* block：\r\n* module：一个commonJS或者AMD文件；\r\n* chunk：多个module打包生成的；\r\n\r\n### 实现原理\r\n\r\n`if(!chunkNames && (selectedChunks === false || async)) {\r\n   commonChunks = chunks;\r\n}else if(Array.isArray(chunkNames)) {\r\n    commonChunks = chunkNames.map(function(chunkName) {\r\n    return chunks.filter(function(chunk) {\r\n        return chunk.name === chunkName;\r\n    })[0];\r\n });\r\n } else {\r\n    commonChunks = chunks.filter(function(chunk) {\r\n        return chunk.name === chunkNames;\r\n    });\r\n}```","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}